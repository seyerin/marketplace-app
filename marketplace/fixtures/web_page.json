[
 {
  "breadcrumbs": null,
  "content_type": "Page Builder",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": null,
  "main_section": null,
  "main_section_html": null,
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-10 23:34:26.038670",
  "module": "marketplace",
  "name": "store",
  "page_blocks": [
   {
    "add_background_image": 1,
    "add_border_at_bottom": 1,
    "add_border_at_top": 0,
    "add_bottom_padding": 1,
    "add_container": 1,
    "add_shade": 0,
    "add_top_padding": 1,
    "background_image": "/files/banner4.jpg",
    "css_class": null,
    "hide_block": 0,
    "parent": "store",
    "parentfield": "page_blocks",
    "parenttype": "Web Page",
    "section_id": null,
    "web_template": "Hero Slider",
    "web_template_values": "{\"slider_name\":\"test\",\"show_indicators\":0,\"show_controls\":0,\"slide_1_image\":\"/files/banner2.jpg\",\"slide_1_title\":\"Food and Beverages\",\"slide_2_content_align\":\"Left\"}"
   },
   {
    "add_background_image": 0,
    "add_border_at_bottom": 0,
    "add_border_at_top": 0,
    "add_bottom_padding": 1,
    "add_container": 1,
    "add_shade": 0,
    "add_top_padding": 1,
    "background_image": null,
    "css_class": "",
    "hide_block": 0,
    "parent": "store",
    "parentfield": "page_blocks",
    "parenttype": "Web Page",
    "section_id": null,
    "web_template": "Product Category Cards",
    "web_template_values": "{\"title\":\"Products\",\"category_1\":\"Buah\",\"category_2\":\"Sayuran\"}"
   },
   {
    "add_background_image": 0,
    "add_border_at_bottom": 0,
    "add_border_at_top": 0,
    "add_bottom_padding": 1,
    "add_container": 1,
    "add_shade": 0,
    "add_top_padding": 1,
    "background_image": null,
    "css_class": null,
    "hide_block": 0,
    "parent": "store",
    "parentfield": "page_blocks",
    "parenttype": "Web Page",
    "section_id": null,
    "web_template": "Item Card Group",
    "web_template_values": "{\"title\":\"Out of the oven\",\"subtitle\":\"Vegetables and all\",\"primary_action_label\":\"See more \",\"primary_action\":\"/all-product\",\"card_1_item\":\"WEB-ITM-0003\",\"card_1_featured\":0,\"card_2_item\":\"WEB-ITM-0004\",\"card_2_featured\":0,\"card_3_item\":\"WEB-ITM-0005\",\"card_3_featured\":0,\"card_4_item\":\"WEB-ITM-0006\",\"card_4_featured\":0,\"card_5_item\":\"WEB-ITM-0007\",\"card_5_featured\":0,\"card_6_featured\":0,\"card_7_featured\":0,\"card_8_featured\":0,\"card_9_featured\":0,\"card_10_featured\":0,\"card_11_featured\":0,\"card_12_featured\":0}"
   },
   {
    "add_background_image": 1,
    "add_border_at_bottom": 0,
    "add_border_at_top": 0,
    "add_bottom_padding": 1,
    "add_container": 1,
    "add_shade": 0,
    "add_top_padding": 1,
    "background_image": "",
    "css_class": null,
    "hide_block": 1,
    "parent": "store",
    "parentfield": "page_blocks",
    "parenttype": "Web Page",
    "section_id": null,
    "web_template": "Section with CTA",
    "web_template_values": "{\"title\":\"Haruno\",\"cta_label\":\"Haruno Little Prince\",\"cta_description\":\"Everyone is a Haruno\",\"show_confetti\":0}"
   }
  ],
  "published": 1,
  "route": "home",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Store",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": "{% set items = frappe.get_list('Item', {'show_in_website': 1, 'disabled': 0}, ['name', 'item_code', 'item_name', 'description', 'website_image', 'standard_selling_rate', 'owner'], order_by='creation desc') %}\r\n\r\n<div class=\"container my-5\">\r\n    <h1 class=\"text-center mb-4\">Selamat Datang di DMarket Marketplace!</h1>\r\n    <p class=\"text-center text-muted mb-5\">Temukan produk terbaik dari berbagai penjual.</p>\r\n\r\n    <div class=\"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4\"> {# Adjusted for more columns on larger screens #}\r\n        {% for item in items %}\r\n            {# Fetch Seller User Details - Assuming item.owner is the User email #}\r\n            {% set seller_user = frappe.get_doc('User', item.owner) if item.owner else none %}\r\n            {# If you have a custom 'Seller Profile' DocType linked to User, fetch that instead #}\r\n            {# To fetch Seller Profile: #}\r\n            {# {% set seller_profile = frappe.get_list('Seller Profile', {'user': item.owner}, ['shop_name'], limit=1) %} #}\r\n            {# {% set seller_name_display = seller_profile[0].shop_name if seller_profile else (seller_user.full_name if seller_user else 'Unknown Seller') %} #}\r\n\r\n            <div class=\"col d-flex\"> {# Use d-flex to make cards equal height #}\r\n                <div class=\"card h-100 shadow-sm border-0 rounded-lg overflow-hidden\">\r\n                    {% if item.website_image %}\r\n                        <img src=\"{{ item.website_image }}\" class=\"card-img-top\" alt=\"{{ item.item_name }}\" style=\"height: 220px; object-fit: cover;\">\r\n                    {% else %}\r\n                        <img src=\"/assets/frappe/images/placeholder.jpg\" class=\"card-img-top\" alt=\"Placeholder\" style=\"height: 220px; object-fit: cover;\">\r\n                    {% endif %}\r\n                    <div class=\"card-body d-flex flex-column\">\r\n                        <h5 class=\"card-title mb-2\">{{ item.item_name }}</h5>\r\n                        <p class=\"card-text text-muted small mb-2\">\r\n                            Oleh: <strong class=\"text-dark\">{{ seller_user.full_name if seller_user else 'Unknown Seller' }}</strong>\r\n                        </p>\r\n                        <p class=\"card-text flex-grow-1\">{{ item.description[:120] }}...</p> {# Show more description #}\r\n                        <div class=\"mt-auto pt-3\">\r\n                            <h4 class=\"text-success fw-bold mb-2\">{{ frappe.format(item.standard_selling_rate, 'Currency') }}</h4>\r\n                            <a href=\"/app/item/{{ item.name }}\" class=\"btn btn-primary w-100\">Lihat Detail</a>\r\n                            {# Optional: Add to Cart button directly here, but it requires JS #}\r\n                            {# <button class=\"btn btn-outline-success w-100 mt-2 add-to-cart-btn\" data-item-code=\"{{ item.item_code }}\">Tambah ke Keranjang</button> #}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        {% endfor %}\r\n    </div>\r\n\r\n    {% if not items %}\r\n        <div class=\"text-center py-5\">\r\n            <p class=\"lead text-muted\">Belum ada produk yang tersedia di marketplace saat ini.</p>\r\n            <p>Silakan kembali lagi nanti atau hubungi kami untuk informasi lebih lanjut.</p>\r\n        </div>\r\n    {% endif %}\r\n</div>\r\n\r\n<style>\r\n    /* Card Styles */\r\n    .card {\r\n        transition: transform 0.2s ease-in-out;\r\n        box-shadow: 0 4px 8px rgba(0,0,0,.05);\r\n        border: 1px solid #e0e0e0; /* Add a subtle border */\r\n    }\r\n    .card:hover {\r\n        transform: translateY(-5px);\r\n        box-shadow: 0 8px 16px rgba(0,0,0,.1);\r\n    }\r\n    .card-img-top {\r\n        border-bottom: 1px solid #e9ecef;\r\n    }\r\n    .card-body {\r\n        padding: 1.5rem;\r\n    }\r\n    .card-title {\r\n        font-size: 1.3rem;\r\n        font-weight: 700;\r\n        line-height: 1.4;\r\n    }\r\n    .card-text.small {\r\n        font-size: 0.875rem;\r\n    }\r\n    .flex-grow-1 {\r\n        flex-grow: 1; /* Ensures description takes available space, pushing button to bottom */\r\n    }\r\n\r\n    /* Text and Button Colors */\r\n    .text-success {\r\n        color: #28a745 !important; /* Standard Bootstrap green */\r\n    }\r\n    .fw-bold {\r\n        font-weight: 700 !important;\r\n    }\r\n    .btn-primary {\r\n        background-color: #007bff; /* Standard Bootstrap blue */\r\n        border-color: #007bff;\r\n    }\r\n    .btn-primary:hover {\r\n        background-color: #0056b3;\r\n        border-color: #0056b3;\r\n    }\r\n\r\n    /* Header and Subtitle */\r\n    .container h1 {\r\n        font-size: 2.5rem;\r\n        font-weight: 700;\r\n    }\r\n    .container p.text-muted.mb-5 {\r\n        font-size: 1.1rem;\r\n    }\r\n\r\n    /* Fallback for no items */\r\n    .lead {\r\n        font-size: 1.25rem;\r\n    }\r\n</style>",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-10 19:11:20.207711",
  "module": "marketplace",
  "name": "store-code",
  "page_blocks": [],
  "published": 0,
  "route": "store-code",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Store code",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": null,
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 0,
  "javascript": null,
  "main_section": null,
  "main_section_html": null,
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-07 14:34:45.773442",
  "module": "marketplace",
  "name": "vendor-registration",
  "page_blocks": [],
  "published": 1,
  "route": "vendor-registration",
  "show_sidebar": 0,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Vendor Registration",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": null,
  "css": "<style>\r\n/* ------------------------------------------- */\r\n/* GLOBAL & UTILITY STYLES */\r\n/* ------------------------------------------- */\r\n* {\r\n    box-sizing: border-box;\r\n}\r\n\r\n.container {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding: 0 15px;\r\n}\r\n\r\n.row {\r\n    margin-right: -15px;\r\n    margin-left: -15px;\r\n}\r\n.row > [class*='col-'] {\r\n    padding-right: 15px;\r\n    padding-left: 15px;\r\n}\r\n\r\n.page-title {\r\n    font-size: 2rem;\r\n    font-weight: 600;\r\n    color: #333;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.nav-tabs .nav-link {\r\n    font-weight: 600;\r\n    color: #555;\r\n    border-color: #dee2e6;\r\n}\r\n.nav-tabs .nav-link.active {\r\n    color: #007bff;\r\n    border-color: #dee2e6 #dee2e6 #fff;\r\n}\r\n\r\n/* ------------------------------------------- */\r\n/* CARD STYLING */\r\n/* ------------------------------------------- */\r\n\r\n.card-proposal, .card-transaction {\r\n    border: none;\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 10px rgba(0,0,0,0.08);\r\n    transition: transform 0.2s, box-shadow 0.2s;\r\n    margin-bottom: 20px;\r\n    background-color: #fff;\r\n    border-left: 5px solid;\r\n}\r\n\r\n.card-proposal:hover, .card-transaction:hover {\r\n    transform: translateY(-5px);\r\n    box-shadow: 0 8px 15px rgba(0,0,0,0.1);\r\n}\r\n\r\n.card-proposal .card-body, .card-transaction .card-body {\r\n    padding: 20px;\r\n}\r\n\r\n.card-proposal .card-title, .card-transaction .card-title {\r\n    font-size: 1.35rem;\r\n    font-weight: 700;\r\n    margin-bottom: 5px;\r\n}\r\n\r\n.card-proposal .card-title a, .card-transaction .card-title a {\r\n    text-decoration: none;\r\n    color: #333;\r\n    transition: color 0.2s;\r\n}\r\n\r\n.card-proposal .card-title a:hover, .card-transaction .card-title a:hover {\r\n    color: #007bff;\r\n    text-decoration: none;\r\n}\r\n\r\n.card-proposal .card-footer {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background-color: #f8f9fa;\r\n    border-top: 1px solid #e9ecef;\r\n    padding: 10px 20px;\r\n}\r\n\r\n/* ------------------------------------------- */\r\n/* STATUS BADGES & BORDER COLORS */\r\n/* ------------------------------------------- */\r\n\r\n.status-badge {\r\n    padding: 6px 12px;\r\n    border-radius: 50px;\r\n    font-size: 11px;\r\n    font-weight: bold;\r\n    color: white;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.5px;\r\n    display: inline-block;\r\n}\r\n\r\n.status-badge.draft { background-color: #6c757d; }\r\n.status-badge.pending { background-color: #ffc107; }\r\n.status-badge.approved { background-color: #28a745; }\r\n.status-badge.rejected { background-color: #dc3545; }\r\n.status-badge.completed { background-color: #007bff; }\r\n\r\n.card-proposal.draft { border-left-color: #6c757d; }\r\n.card-proposal.pending { border-left-color: #ffc107; }\r\n.card-proposal.approved { border-left-color: #28a745; }\r\n.card-proposal.rejected { border-left-color: #dc3545; }\r\n.card-transaction.completed { border-left-color: #007bff; }\r\n\r\n/* ------------------------------------------- */\r\n/* EMPTY STATE */\r\n/* ------------------------------------------- */\r\n\r\n.empty-state-card {\r\n    padding: 50px 30px;\r\n    border: 2px dashed #e0e0e0;\r\n    border-radius: 10px;\r\n    background-color: #fafafa;\r\n    text-align: center;\r\n    margin-top: 30px;\r\n}\r\n\r\n.empty-state-card .fa-3x {\r\n    color: #ccc;\r\n}\r\n\r\n.empty-state-card h3 {\r\n    margin-top: 15px;\r\n    color: #555;\r\n    font-size: 1.5rem;\r\n}\r\n\r\n.empty-state-card p {\r\n    color: #888;\r\n}\r\n\r\n\r\n</style>",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": "frappe.ready(function() {\r\n\r\n    // Logic untuk Modal Revisi Harga\r\n    $('#amendModal').on('show.bs.modal', function(event) {\r\n        var button = $(event.relatedTarget);\r\n        var proposalName = button.data('proposal-name');\r\n        var currentPrice = button.data('current-price');\r\n        var modal = $(this);\r\n        modal.find('#amend_proposal_name').val(proposalName);\r\n        modal.find('#amend_current_price').val(currentPrice);\r\n        modal.find('#amend_new_price').val('');\r\n    });\r\n\r\n    $('#submitAmendBtn').on('click', function() {\r\n        var proposalName = $('#amend_proposal_name').val();\r\n        var newPrice = $('#amend_new_price').val();\r\n        \r\n        if (!newPrice) {\r\n            frappe.msgprint({\r\n                title: 'Perhatian',\r\n                message: 'Harga baru tidak boleh kosong.',\r\n                indicator: 'red'\r\n            });\r\n            return;\r\n        }\r\n\r\n        frappe.call({\r\n            method: \"marketplace.utils.amends_proposal.create_amended_proposal\",\r\n            args: {\r\n                name: proposalName,\r\n                new_price: newPrice\r\n            },\r\n            callback: function(r) {\r\n                if (!r.exc) {\r\n                    $('#amendModal').modal('hide');\r\n                    frappe.set_route(\"Form\", \"Supplier Product Proposal\", r.message);\r\n                    frappe.msgprint({\r\n                        title: \"Berhasil\",\r\n                        indicator: 'green',\r\n                        message: `Revisi berhasil dibuat. Mengarahkan Anda ke dokumen revisi baru: ${r.message}`\r\n                    });\r\n                } else {\r\n                    frappe.msgprint({\r\n                        title: \"Gagal Membuat Revisi\",\r\n                        indicator: 'red',\r\n                        message: r.exc\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n\r\n});",
  "main_section": null,
  "main_section_html": "{% block page_content %}\r\n\r\n<div class=\"container\">\r\n    <div class=\"row\">\r\n        <div class=\"col-12 d-flex justify-content-between align-items-center mb-4\">\r\n            <h2 class=\"page-title\">Beranda Supplier</h2>\r\n            <a href=\"/supplier-product-proposal\" class=\"btn btn-primary btn-lg\">\r\n                <i class=\"fas fa-plus\"></i> Ajukan Produk Baru\r\n            </a>\r\n        </div>\r\n    </div>\r\n\r\n    <ul class=\"nav nav-tabs\" id=\"supplierDashboardTab\" role=\"tablist\">\r\n        <li class=\"nav-item\">\r\n            <a class=\"nav-link active\" id=\"proposals-tab\" data-toggle=\"tab\" href=\"#proposals\" role=\"tab\" aria-controls=\"proposals\" aria-selected=\"true\">\r\n                Produk Anda\r\n            </a>\r\n        </li>\r\n    </ul>\r\n    <div class=\"tab-content\" id=\"supplierDashboardTabContent\">\r\n\r\n        <div class=\"tab-pane fade show active\" id=\"proposals\" role=\"tabpanel\" aria-labelledby=\"proposals-tab\">\r\n            <div class=\"row mt-4\">\r\n                {%- set proposals_raw = frappe.get_list(\"Supplier Product Proposal\", filters={ \"owner\": frappe.session.user }, fields=[\"name\", \"product_name\", \"stat\", \"supplier_price\", \"amended_from\"], order_by=\"creation desc\") -%}\r\n                {%- set unique_proposals = {} -%}\r\n                {%- for proposal in proposals_raw -%}\r\n                    {%- set key = proposal.amended_from if proposal.amended_from else proposal.name -%}\r\n                    \r\n                    {%- if key not in unique_proposals or unique_proposals.get(key).amended_from == proposal.amended_from -%}\r\n                        {%- set unique_proposals = unique_proposals.update({key: proposal}) or unique_proposals -%}\r\n                    {%- endif -%}\r\n                {%- endfor -%}\r\n\r\n                {% if unique_proposals %}\r\n                    {% for proposal in unique_proposals.values() %}\r\n                        {%- set status_class = proposal.stat | lower | replace(\" \", \"-\") -%}\r\n                        <div class=\"col-md-6\">\r\n                            <div class=\"card card-proposal {{ status_class }}\">\r\n                                <div class=\"card-body\">\r\n                                    <h5 class=\"card-title\">\r\n                                        <a href=\"/web-form/supplier-product-proposal-form?name={{ proposal.name }}\">\r\n                                            {{ proposal.product_name }}\r\n                                        </a>\r\n                                    </h5>\r\n                                </div>\r\n                                <div class=\"card-footer\">\r\n                                    <span class=\"status-badge {{ status_class }}\">\r\n                                        {{ proposal.stat }}\r\n                                    </span>\r\n                                    {% if proposal.stat == \"Approved\" %}\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        class=\"btn btn-warning btn-sm\"\r\n                                        data-toggle=\"modal\"\r\n                                        data-target=\"#amendModal\"\r\n                                        data-proposal-name=\"{{ proposal.name }}\"\r\n                                        data-current-price=\"{{ proposal.supplier_price }}\">\r\n                                        Ajukan Revisi Harga\r\n                                    </button>\r\n                                    {% endif %}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    {% endfor %}\r\n                {% else %}\r\n                    <div class=\"col-12\">\r\n                        <div class=\"empty-state-card\">\r\n                            <i class=\"fas fa-file-alt fa-3x text-muted mb-3\"></i>\r\n                            <h3>Anda belum mengajukan proposal produk.</h3>\r\n                            <p class=\"text-muted\">Klik tombol \"Ajukan Produk Baru\" untuk memulai.</p>\r\n                        </div>\r\n                    </div>\r\n                {% endif %}\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal fade\" id=\"amendModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"amendModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"amendModalLabel\">Ajukan Revisi Harga</h5>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                    <span aria-hidden=\"true\">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <form id=\"amendForm\">\r\n                    <div class=\"form-group\">\r\n                        <label for=\"proposal_name\">Nomor Proposal</label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"amend_proposal_name\" name=\"proposal_name\" readonly>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label for=\"current_price\">Harga Lama</label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"amend_current_price\" name=\"current_price\" readonly>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label for=\"new_price\">Harga Baru <span class=\"text-danger\">*</span></label>\r\n                        <input type=\"number\" class=\"form-control\" id=\"amend_new_price\" name=\"new_price\" required min=\"0\" step=\"any\">\r\n                        <small class=\"form-text text-muted\">Masukkan harga revisi yang baru.</small>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Tutup</button>\r\n                <button type=\"button\" class=\"btn btn-primary\" id=\"submitAmendBtn\">Ajukan Revisi</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n{% endblock %}",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-12 09:23:03.074652",
  "module": "marketplace",
  "name": "dashboard-supplier",
  "page_blocks": [],
  "published": 1,
  "route": "supplier-dashboard",
  "show_sidebar": 1,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Dashboard Supplier",
  "website_sidebar": null
 },
 {
  "breadcrumbs": null,
  "content_type": "HTML",
  "context_script": "",
  "css": "/* ------------------------------------------- */\r\n/* GLOBAL & UTILITY STYLES */\r\n/* ------------------------------------------- */\r\n* {\r\n    box-sizing: border-box;\r\n}\r\n\r\n.container {\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding: 0 15px;\r\n}\r\n\r\n.row {\r\n    margin-right: -15px;\r\n    margin-left: -15px;\r\n}\r\n.row > [class*='col-'] {\r\n    padding-right: 15px;\r\n    padding-left: 15px;\r\n}\r\n\r\n.page-title {\r\n    font-size: 2rem;\r\n    font-weight: 600;\r\n    color: #333;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n/* ------------------------------------------- */\r\n/* CARD STYLING */\r\n/* ------------------------------------------- */\r\n\r\n.card-transaction {\r\n    border: none;\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 10px rgba(0,0,0,0.08);\r\n    transition: transform 0.2s, box-shadow 0.2s;\r\n    margin-bottom: 20px;\r\n    background-color: #fff;\r\n    border-left: 5px solid #007bff; /* Border color for completed transactions */\r\n}\r\n\r\n.card-transaction:hover {\r\n    transform: translateY(-5px);\r\n    box-shadow: 0 8px 15px rgba(0,0,0,0.1);\r\n}\r\n\r\n.card-transaction .card-body {\r\n    padding: 20px;\r\n}\r\n\r\n.card-transaction .card-title {\r\n    font-size: 1.35rem;\r\n    font-weight: 700;\r\n    margin-bottom: 5px;\r\n}\r\n\r\n.card-transaction .card-title a {\r\n    text-decoration: none;\r\n    color: #333;\r\n    transition: color 0.2s;\r\n}\r\n\r\n.card-transaction .card-title a:hover {\r\n    color: #007bff;\r\n    text-decoration: none;\r\n}\r\n\r\n.card-transaction .card-footer {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background-color: #f8f9fa;\r\n    border-top: 1px solid #e9ecef;\r\n    padding: 10px 20px;\r\n}\r\n\r\n/* ------------------------------------------- */\r\n/* EMPTY STATE */\r\n/* ------------------------------------------- */\r\n\r\n.empty-state-card {\r\n    padding: 50px 30px;\r\n    border: 2px dashed #e0e0e0;\r\n    border-radius: 10px;\r\n    background-color: #fafafa;\r\n    text-align: center;\r\n    margin-top: 30px;\r\n}\r\n\r\n.empty-state-card .fa-3x {\r\n    color: #ccc;\r\n}\r\n\r\n.empty-state-card h3 {\r\n    margin-top: 15px;\r\n    color: #555;\r\n    font-size: 1.5rem;\r\n}\r\n\r\n.empty-state-card p {\r\n    color: #888;\r\n}\r\n\r\n/* ------------------------------------------- */\r\n/* REVIEW MODAL STYLING */\r\n/* ------------------------------------------- */\r\n\r\n.rating-stars {\r\n    display: inline-block;\r\n    margin-top: 10px;\r\n}\r\n.rating-stars .fa-star {\r\n    font-size: 1.5rem;\r\n    color: #ccc;\r\n    cursor: pointer;\r\n    transition: color 0.2s;\r\n}\r\n.rating-stars .fa-star.checked, .rating-stars .fa-star:hover {\r\n    color: #ffc107;\r\n}",
  "docstatus": 0,
  "doctype": "Web Page",
  "dynamic_route": 0,
  "dynamic_template": 0,
  "enable_comments": 0,
  "end_date": null,
  "full_width": 1,
  "header": null,
  "insert_style": 1,
  "javascript": "frappe.ready(function() {\r\n    $(document).ready(function() {\r\n        $('#reviewModal').on('show.bs.modal', function (event) {\r\n            var button = $(event.relatedTarget);\r\n            var transactionName = button.data('transaction-name');\r\n            var modal = $(this);\r\n            modal.find('#sales_order_name').val(transactionName);\r\n            \r\n            $('#reviewForm')[0].reset();\r\n            $('#ratingInput').val('');\r\n            $('#ratingStars .fa-star').removeClass('checked');\r\n        });\r\n\r\n        $('#ratingStars .fa-star').on('click', function() {\r\n            var rating = $(this).data('rating');\r\n            $('#ratingInput').val(rating);\r\n            $('#ratingStars .fa-star').removeClass('checked');\r\n            $(this).prevAll().addBack().addClass('checked');\r\n        });\r\n\r\n        $('#submitReviewBtn').on('click', function() {\r\n            var salesOrderName = $('#sales_order_name').val();\r\n            var headline = $('#headline').val();\r\n            var rating = $('#ratingInput').val();\r\n            var reviewText = $('#reviewText').val();\r\n\r\n            if (!headline || !rating) {\r\n                frappe.msgprint({\r\n                    title: 'Perhatian',\r\n                    message: 'Judul ulasan dan Rating tidak boleh kosong.',\r\n                    indicator: 'red'\r\n                });\r\n                return;\r\n            }\r\n\r\n            frappe.call({\r\n                method: \"marketplace.api.create_buyer_review\",\r\n                args: {\r\n                    sales_order_name: salesOrderName,\r\n                    headline: headline,\r\n                    rating: rating,\r\n                    review_text: reviewText\r\n                },\r\n                callback: function(r) {\r\n                    if (!r.exc) {\r\n                        frappe.msgprint({\r\n                            title: \"Berhasil\",\r\n                            indicator: 'green',\r\n                            message: 'Ulasan Anda berhasil disimpan. Halaman akan dimuat ulang.'\r\n                        });\r\n                        $('#reviewModal').modal('hide');\r\n                        location.reload();\r\n                    } else {\r\n                        frappe.msgprint({\r\n                            title: \"Gagal\",\r\n                            indicator: 'red',\r\n                            message: 'Terjadi kesalahan saat menyimpan ulasan.'\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    });\r\n});",
  "main_section": null,
  "main_section_html": "{% block page_content %}\r\n\r\n\r\n<div class=\"container\">\r\n    <div class=\"row\">\r\n        <div class=\"col-12 d-flex justify-content-between align-items-center mb-4\">\r\n            <h2 class=\"page-title\">Ulasan Pembeli</h2>\r\n        </div>\r\n    </div>\r\n    <div class=\"row mt-4\">\r\n        {%- set reviewed_sales_orders = frappe.get_list(\"Review Buyer\", \r\n            filters={ \"supplier\": frappe.session.user }, \r\n            fields=[\"sales_order\"]) -%}\r\n\r\n        {%- set reviewed_sales_order_names = reviewed_sales_orders | map(attribute='sales_order') | list -%}\r\n\r\n        {%- set completed_sales_orders = frappe.get_list(\"Sales Order\", \r\n            filters={ \"supplier\": frappe.session.user, \"docstatus\": 1, \"status\": \"Selesai\" }, \r\n            fields=[\"name\", \"customer_name\", \"product_name\"],\r\n            order_by=\"`tabSales Order`.creation desc\") -%}\r\n        \r\n        {%- set pending_review_sales_orders = [] -%}\r\n        {% for so in completed_sales_orders %}\r\n            {% if so.name not in reviewed_sales_order_names %}\r\n                {% set _ = pending_review_sales_orders.append(so) %}\r\n            {% endif %}\r\n        {% endfor %}\r\n\r\n        {% if pending_review_sales_orders %}\r\n            {% for transaction in pending_review_sales_orders %}\r\n                <div class=\"col-md-6\">\r\n                    <div class=\"card card-transaction\">\r\n                        <div class=\"card-body\">\r\n                            <h5 class=\"card-title\">\r\n                                Transaksi dengan {{ transaction.customer_name }}\r\n                            </h5>\r\n                            <p class=\"card-text\">\r\n                                Produk: {{ transaction.product_name }}\r\n                            </p>\r\n                        </div>\r\n                        <div class=\"card-footer\">\r\n                            <button class=\"btn btn-primary\"\r\n                                data-toggle=\"modal\"\r\n                                data-target=\"#reviewModal\"\r\n                                data-transaction-name=\"{{ transaction.name }}\">\r\n                                Berikan Ulasan\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            {% endfor %}\r\n        {% else %}\r\n            <div class=\"col-12\">\r\n                <div class=\"empty-state-card\">\r\n                    <i class=\"fas fa-star fa-3x text-muted mb-3\"></i>\r\n                    <h3>Tidak ada transaksi yang menunggu ulasan.</h3>\r\n                    <p class=\"text-muted\">Silahkan cek kembali nanti setelah transaksi selesai.</p>\r\n                </div>\r\n            </div>\r\n        {% endif %}\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal fade\" id=\"reviewModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"reviewModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\" id=\"reviewModalLabel\">Berikan Ulasan</h5>\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                    <span aria-hidden=\"true\">&times;</span>\r\n                </button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <form id=\"reviewForm\">\r\n                    <input type=\"hidden\" name=\"sales_order_name\" id=\"sales_order_name\">\r\n                    <div class=\"form-group\">\r\n                        <label for=\"headline\">Judul Ulasan <span class=\"text-danger\">*</span></label>\r\n                        <input type=\"text\" class=\"form-control\" id=\"headline\" name=\"headline\" required>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label for=\"rating\">Rating <span class=\"text-danger\">*</span></label>\r\n                        <div class=\"rating-stars\" id=\"ratingStars\">\r\n                            <span class=\"fa fa-star\" data-rating=\"1\"></span>\r\n                            <span class=\"fa fa-star\" data-rating=\"2\"></span>\r\n                            <span class=\"fa fa-star\" data-rating=\"3\"></span>\r\n                            <span class=\"fa fa-star\" data-rating=\"4\"></span>\r\n                            <span class=\"fa fa-star\" data-rating=\"5\"></span>\r\n                        </div>\r\n                        <input type=\"hidden\" name=\"rating\" id=\"ratingInput\" required>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label for=\"reviewText\">Isi Ulasan Anda</label>\r\n                        <textarea class=\"form-control\" id=\"reviewText\" name=\"reviewText\" rows=\"4\"></textarea>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Tutup</button>\r\n                <button type=\"button\" class=\"btn btn-primary\" id=\"submitReviewBtn\">Kirim Ulasan</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\r\n{% endblock %}",
  "main_section_md": null,
  "meta_description": null,
  "meta_image": null,
  "meta_title": null,
  "modified": "2025-08-12 02:33:54.710397",
  "module": "marketplace",
  "name": "ulasan-pembeli",
  "page_blocks": [],
  "published": 1,
  "route": "ulasan-pembeli",
  "show_sidebar": 1,
  "show_title": 0,
  "slideshow": null,
  "start_date": null,
  "text_align": "Left",
  "title": "Ulasan Pembeli",
  "website_sidebar": null
 }
]